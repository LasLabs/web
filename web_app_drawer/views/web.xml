<?xml version="1.0" encoding="utf-8"?>

<!--
    Copyright 2016 LasLabs Inc.
    License LGPL-3.0 or later (http://www.gnu.org/licenses/lgpl.html).
-->

<odoo>

	<template id="web.webclient_bootstrap" name="Webclient Mobile">
		<t t-call="web.layout">
			
			<t t-set="head">
				
				<meta charset="utf-8" />
				<meta http-equiv="cleartype" content="on" />
				<meta name="MobileOptimized" content="320" />
				<meta name="HandheldFriendly" content="True" />
				<meta name="apple-mobile-web-app-capable" content="yes" />
				<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
					
				<t t-call-assets="web.assets_common"/>
				
				<script type="application/javascript">
					odoo.define('web.csrf', function (require) {
						var token = "<t t-esc="request.csrf_token(None)"/>";
						require('web.core').csrf_token = token;
						require('qweb').default_dict.csrf_token = token;
					});
					odoo.db_info = <t t-raw="db_info"/>;
				</script>
				
				<t t-call-assets="web.assets_backend"/>
				&lt;!--[if lte IE 9]&gt; <link rel="stylesheet" href="/web/static/src/css/ie.css"/> &lt;![endif]--&gt;
				
				<script type="application/javascript">
					$(function() {
						<t t-if="init">
							<t t-raw="init"/>
						</t>
						<t t-if="not init">
							odoo.define('web.web_client', function (require) {
								var WebClient = require('web.WebClient');
								var web_client = new WebClient();
								web_client.setElement($(document.body));
								web_client.start();
								return web_client;
							});
						</t>
					});
				</script>

			</t>
			
			<t t-set="body_classname" t-value="'drawer drawer--left'" />
				
			<header role="banner">
				<nav id="odooAppDrawer" class="css-app-drawer-nav drawer-nav" role="navigation">
					<t t-call="web.menu" />
				</nav>
			</header>
				
			<main role="main">
				
				<nav class="navbar navbar-default css-main-nav"
					 role="navigation"
					 groups="base.group_user,base.group_portal"
					 >
					<div class="container-fluid">
						
						<div class="navbar-header">
							
							<a href="#"
							   class="drawer-toggle pull-left navbar-collapse collapse btn btn-default css-app-drawer-toggle"
							   accesskey="A"
							   >
								<span class="sr-only">Toggle Navigation</span>
								<i class="fa fa-th fa-2x css-app-drawer-icon-open" />
							</a>
							
							<button type="button"
									class="css-app-drawer-toggle drawer-toggle pull-left navbar-toggle collapsed"
									>
								<span class="sr-only">Toggle Navigation</span>
								<i class="fa fa-th fa-2x css-app-drawer-icon-open" />
							</button>
							
							<a href="#" class="css-app-drawer-icon-close btn btn-danger">
								<i class="fa fa-times fa-3x drawer-toggle" />
							</a>
							
							<button type="button"
									id="odooMenuBarToggle"
									class="navbar-toggle collapsed pull-right"
									data-toggle="collapse"
									data-target="#odooMenuBarNav"
									>
								<span class="sr-only">Toggle Navigation</span>
								<i class="fa fa-bars fa-2x" />
							</button>
							
						</div>
						
						<div class="collapse navbar-collapse text-center"
							 id="odooMenuBarNav"
							 data-parent="#odooMenuBarToggle"
							 aria-expanded="false"
							 >
							<div class="nav navbar-nav oe_secondary_menus_container">
								<t t-call="web.menu_secondary" />
							</div>
							<div class="nav navbar-nav navbar-right">
								<ul class="nav navbar-nav navbar-right oe_user_menu_placeholder"
									style="display: none;"
									/>
								<ul class="nav navbar-nav navbar-right oe_systray"
									style="display: none;"
									/>
							</div>
						</div>
					</div>
				</nav>

				<div class="openerp openerp_webclient_container oe_webclient">
					<div class="oe_application"/>
				</div>
			
			</main>
			
		</t>
	</template>

		</xpath>
		
    </template>

    <template id="menu_secondary"
              inherit_id="web.menu_secondary"
              name="App Drawer - Secondary Menu"
              >
        
        <xpath expr="//a[@class='oe_logo']" position="attributes">
            <attribute name="style">display: none;</attribute>
        </xpath>
        
        <xpath expr="//div[@class='oe_footer']" position="attributes">
            <attribute name="style">display: none;</attribute>
        </xpath>
        
        <xpath expr="//div[@class='oe_secondary_menus_container']/t" position="replace">
        
            <t t-foreach="menu_data['children']" t-as="menu">
                <ul style="display: none" class="oe_secondary_menu nav navbar-nav" t-att-data-menu-parent="menu['id']">
                    <t t-call="web.menu_secondary_submenu" />
                </ul>
            </t>
            
        </xpath>
        
    </template>

    <template id="menu_secondary_submenu"
              inherit_id="web.menu_secondary_submenu"
              name="App Drawer - Secondary Submenu"
              >
        
        <xpath expr="//ul" position="replace">
        
            <t t-foreach="menu['children']" t-as="menu">
                <t t-if="menu['children']">
                    <li t-attf-class="{{ 'dropdown-submenu' if submenu else '' }}">
                        <t t-if="submenu">
                            <a href="#" class="dropdown-toggle">
                                <t t-esc="menu['name']" />
                             </a>
                        </t>
                        <t t-if="not submenu">
                            <a href="#"
                               class="dropdown-toggle"
                               data-toggle="dropdown"
                               role="button"
                               aria-haspopup="true"
                               aria-expanded="false"
                               >
                                <t t-esc="menu['name']" />
                                <span class="caret" />
                             </a>
                        </t>
                        <ul t-if="menu['children']"
                            t-attf-class="dropdown-menu oe_secondary_submenu"
                            >
                            <t t-call="web.menu_secondary_submenu">
                                <t t-set="submenu" t-value="True" />
                            </t>
                        </ul>
                    </li>
                </t>
                <t t-if="not menu['children']">
                    <li>
                        <t t-call="web.menu_link" />
                    </li>
                </t>
            </t>
            
        </xpath>
        
    </template>

    <template id="menu_link"
              inherit_id="web.menu_link"
              name="App Drawer - Menu Link"
              >
        
        <xpath expr="//span[@class='oe_menu_text']" position="replace">
            <t t-if="display_images">
                <img t-attf-src="/web/image/ir.ui.menu/{{ menu['id'] }}/web_icon_data"
                     class="app-drawer-icon-app img-rounded"
                     t-att-alt="menu['name']"
                     t-att-title="menu['name']"
                     />
                <span class="app-drawer-title text-left navbar-toggle collapsed">
                    <t t-esc="menu['name']" />
                </span>
                <span class="app-drawer-title text-center collapse navbar-collapse">
                    <t t-esc="menu['name']" />
                </span>
            </t>
            <t t-if="not display_images">
                <span class="oe_menu_text">
                    <t t-esc="menu['name']" />
                </span>
            </t>
        </xpath>
        
    </template>

    <template id="menu"
              inherit_id="web.menu"
              name="App Drawer - Menu"
              >
        
        <xpath expr="//ul[contains(@class, 'oe_systray')]" position="attributes">
            <attribute name="class">hidden</attribute>
        </xpath>
        
        <xpath expr="//ul[contains(@class, 'oe_user_menu_placeholder')]" position="attributes">
            <attribute name="class">hidden</attribute>
        </xpath>
        
        <xpath expr="//ul[contains(@class, 'oe_application_menu_placeholder')]" position="replace">
            
            <div class="panel panel-default app-drawer-app-panel" id="appDrawerAppMenu">
                <div class="panel-heading" id="appDrawerAppPanelHead">
                    <h3 class="panel-title">
                        Apps
                    </h3>
                </div>
                <div class="panel-body" id="appDrawerAppPanelBody">
                    <ul class="nav navbar-nav navbar-left oe_application_menu_placeholder" style="display: none;">
                        <li t-foreach="menu_data['children']" t-as="menu">
                            <t t-call="web.menu_link">
                                <t t-set="display_images" t-value="1" />
                            </t>
                        </li>
                        <li id="menu_more_container" class="dropdown" style="display: none;">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">More <b class="caret"></b></a>
                            <ul id="menu_more" class="dropdown-menu"></ul>
                        </li>
                    </ul>
                </div>
            </div>
            
        </xpath>
        
        
    </template>

</odoo>
